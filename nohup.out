2023-02-05 23:19:49.906478: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-05 23:19:50.062234: I tensorflow/core/util/port.cc:104] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2023-02-05 23:19:50.458838: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer.so.7'; dlerror: libnvinfer.so.7: cannot open shared object file: No such file or directory
2023-02-05 23:19:50.458919: W tensorflow/compiler/xla/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libnvinfer_plugin.so.7'; dlerror: libnvinfer_plugin.so.7: cannot open shared object file: No such file or directory
2023-02-05 23:19:50.458927: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Cannot dlopen some TensorRT libraries. If you would like to use Nvidia GPU with TensorRT, please make sure the missing libraries mentioned above are installed properly.
Output directory (adv_results) already exists and is not empty.
Data import finished!
Building Model...
Model built!
Building vocab...
Building cos sim matrix...
Start computing the cosine similarity matrix!
Cos sim import finished!
2023-02-05 23:20:46.777466: I tensorflow/core/platform/cpu_feature_guard.cc:193] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 AVX512F AVX512_VNNI FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-02-05 23:20:46.784678: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21425 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6
2023-02-05 23:20:46.833632: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1613] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 21425 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6
2023-02-05 23:20:47.815446: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:357] MLIR V1 optimization pass is not enabled
Start attacking!
0 samples out of 1000 have been finished!
2023-02-05 23:20:51.779285: I tensorflow/compiler/xla/stream_executor/cuda/cuda_blas.cc:630] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
20 samples out of 1000 have been finished!
40 samples out of 1000 have been finished!
60 samples out of 1000 have been finished!
80 samples out of 1000 have been finished!
100 samples out of 1000 have been finished!
120 samples out of 1000 have been finished!
140 samples out of 1000 have been finished!
160 samples out of 1000 have been finished!
180 samples out of 1000 have been finished!
200 samples out of 1000 have been finished!
220 samples out of 1000 have been finished!
240 samples out of 1000 have been finished!
260 samples out of 1000 have been finished!
280 samples out of 1000 have been finished!
300 samples out of 1000 have been finished!
320 samples out of 1000 have been finished!
340 samples out of 1000 have been finished!
360 samples out of 1000 have been finished!
380 samples out of 1000 have been finished!
400 samples out of 1000 have been finished!
420 samples out of 1000 have been finished!
440 samples out of 1000 have been finished!
460 samples out of 1000 have been finished!
480 samples out of 1000 have been finished!
500 samples out of 1000 have been finished!
520 samples out of 1000 have been finished!
540 samples out of 1000 have been finished!
560 samples out of 1000 have been finished!
580 samples out of 1000 have been finished!
600 samples out of 1000 have been finished!
620 samples out of 1000 have been finished!
640 samples out of 1000 have been finished!
660 samples out of 1000 have been finished!
680 samples out of 1000 have been finished!
700 samples out of 1000 have been finished!
720 samples out of 1000 have been finished!
740 samples out of 1000 have been finished!
760 samples out of 1000 have been finished!
780 samples out of 1000 have been finished!
800 samples out of 1000 have been finished!
820 samples out of 1000 have been finished!
840 samples out of 1000 have been finished!
860 samples out of 1000 have been finished!
880 samples out of 1000 have been finished!
900 samples out of 1000 have been finished!
920 samples out of 1000 have been finished!
940 samples out of 1000 have been finished!
960 samples out of 1000 have been finished!
980 samples out of 1000 have been finished!
For target model bert: original accuracy: 97.000%, adv accuracy: 6.900%, avg changed rate: 13.800%, num of queries: 826.9

